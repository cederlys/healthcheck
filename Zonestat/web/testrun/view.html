<h1>Testruns for <% $name %></h1>

<h2>Data points</h2>
<table>
    <tr>
        <td>&nbsp;</td>
%foreach my $t (@tr) {
        <th><% $t->name %></th>
% }
    </tr>
    <tr>
        <th>Domains using IPv6</th>
% foreach my $t (@tr) {
        <td class="numeric"><% sprintf "%0.2f", $zs->present->ipv6_percentage_for_testrun($t) %>%</td>
% }
    </tr>
    <tr>
        <th>Domains announced in more than one AS (IPv4)</th>
% foreach my $t (@tr) {
        <td class="numeric"><% sprintf "%0.2f", $zs->present->multihome_percentage_for_testrun($t,0) %>%</td>
% }
    </tr>
    <tr>
        <th>Domains announced in more than one AS (IPv6)</th>
% foreach my $t (@tr) {
        <td class="numeric"><% sprintf "%0.2f", $zs->present->multihome_percentage_for_testrun($t,1) %>%</td>
% }
    </tr>
    <tr>
        <th>Domains using DNSSEC</th>
% foreach my $t (@tr) {
        <td class="numeric"><% sprintf "%0.2f", $zs->present->dnssec_percentage_for_testrun($t) %>%</td>
% }
    </tr>
    <tr>
        <th>Domains with open recursive nameserver(s)</th>
% foreach my $t (@tr) {
        <td class="numeric"><% sprintf "%0.2f", $zs->present->recursing_percentage_for_testrun($t) %>%</td>
% }
    </tr>
</table>

<h2>Common problems</h2>
<& /table/common_problems, sid => \@tid &>

<h2>Number of tests by highest severity problem</h2>
<& /table/max_severity, sid => \@tid &>

<h2>Webserver software</h2>
<& /table/webserver_types, sid => \@tid &>

<h2>Webserver software (https)</h2>
<& /table/webserver_types, sid => \@tid, https => 1 &>

<h2>Webserver response codes</h2>
<& /table/webserver_responses, sid => \@tid &>

<h2>Webserver response codes (https)</h2>
<& /table/webserver_responses, sid => \@tid, https => 1 &>

<h2>Webserver content types</h2>
<& /table/webserver_content, sid => \@tid &>

<h2>Webserver content types (https)</h2>
<& /table/webserver_content, sid => \@tid, https => 1 &>

<h2>Webserver character encodings</h2>
<& /table/webserver_charset, sid => \@tid &>

<h2>Webserver character encodings (https)</h2>
<& /table/webserver_charset, sid => \@tid, https => 1 &>

<h2>DNS servers hosting most domains</h2>
% foreach my $t (@tid) {
    <img src="<% $zs->present->google_mapchart_url($t, 'DNS') %>">
<& /table/top_servers, kind => 'DNS', trid => $t &>
% }

<h2>Web servers hosting most domains</h2>
% foreach my $t (@tid) {
    <img src="<% $zs->present->google_mapchart_url($t, 'HTTP') %>">
<& /table/top_servers, kind => 'HTTP', trid => $t &>
% }

<h2>Mail servers hosting most domains</h2>
% foreach my $t (@tid) {
    <img src="<% $zs->present->google_mapchart_url($t, 'SMTP') %>">
<& /table/top_servers, kind => 'SMTP', trid => $t &>
% }

<h2>ASNs hosting most domains (ipv4)</h2>
<& /table/top_asn, sid => \@tid &>

<h2>ASNs hosting most domains (ipv6)</h2>
<& /table/top_asn, sid => \@tid, ipv6 => 1 &>

<h2>Unknown webserver identifications</h2>
<& /table/unknown_server_types, sid => \@tid &>

<%args>
@tid => ()
</%args>
<%init>
my @tr;
my $name;

if (@tid) {
    @tr = map {$zs->present->dbx('Testrun')->find($_)} @tid;
    $name = $tr[0]->domainset->name;
} else {
    $m->redirect('/')
}
</%init>
<%method title>ZoneStat: Testruns</%method>
